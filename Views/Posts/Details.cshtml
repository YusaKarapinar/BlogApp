@model Post

@{
    ViewData["Title"] = Model.PostName;
}
@section Styles {
    <link rel="stylesheet" href="~/css/PostDetails.css" />
}
<div class="row">
    <!-- Main Post Content -->
    <div class="col-lg-8">
        <div class="post-card bg-white p-4 rounded shadow-sm">
            <!-- Post Title -->
            <h1 class="post-title">@Model.PostName</h1>

            <!-- Post Tags -->
            <div class="post-tags mb-3">
                @foreach(var postTag in Model.PostTags)
                {
                    <span class="badge bg-@(postTag.TagColor?.ToString().ToLower() ?? "secondary") bg-opacity-10 text-dark">
                        @postTag.TagName
                    </span>
                }
            </div>

            <!-- Post Image -->
            <img src="~/img/@(string.IsNullOrEmpty(Model.PostImage) ? "defaultPostImage.jpg" : Model.PostImage)" 
                 class="post-image img-fluid rounded mb-3" alt="@Model.PostName">

            <!-- Post Text -->
            <div class="post-text mb-4">@Model.PostText</div>

            <!-- Comments Section -->
            <div class="comments-section bg-white mt-4 p-3 rounded shadow-sm">
                <div class="comments-header mb-3">
                    <h4>@Model.PostComments.Count() Comments</h4>
                </div>

                <!-- Add Comment Form -->
                <div class="add-comment mb-4">
                    <h5>Add a Comment</h5>
                    <form asp-controller="Posts" asp-action="AddComment" method="post">
                        <input type="hidden" name="PostId" id="PostId" value="@Model.PostId" />
                        <div class="mb-3">
                            <label for="CommentText" class="form-label">Comment</label>
                            <textarea id="CommentText" name="CommentText" class="form-control" rows="3"></textarea>
                        </div>
                        <button id="btnYorumKayit" type="submit" class="btn btn-primary">Submit</button>
                    </form>
                </div>

                <!-- Comments List -->
                <div id="commentsList">
                    @foreach (var comment in Model.PostComments)
                    {
                        <div class="comment-item d-flex mb-3">
                            <img src="~/img/@(string.IsNullOrEmpty(comment.User.UserImage) ? "default.png" : comment.User.UserImage)" 
                                 alt="@comment.User.UserName" class="avatar rounded-circle me-3">
                            <div class="comment-content">
                                <h6>@comment.User.UserName</h6>
                                <span class="text-muted small">@comment.CommentDate.ToString("dd MMMM yyyy")</span>
                                <p>@comment.CommentText</p>
                            </div>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Sidebar -->
    <div class="col-lg-4">
        <vc:tags-menu></vc:tags-menu>
        <div class="mt-3"></div>
        <vc:new-posts></vc:new-posts>
        <div class="mt-3"></div>
        <vc:users-menu></vc:users-menu>
    </div>
</div>
